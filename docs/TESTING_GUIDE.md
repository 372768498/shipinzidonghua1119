# YouTubeçˆ†æ¬¾å‘çŽ°åŠŸèƒ½æµ‹è¯•æŒ‡å—

> **æµ‹è¯•ç›®æ ‡**ï¼šéªŒè¯YouTube Shortsçˆ†æ¬¾å‘çŽ°åŠŸèƒ½çš„å®Œæ•´æµç¨‹ï¼ŒåŒ…æ‹¬è¯„åˆ†ç®—æ³•ã€AIåˆ†æžå’Œå®žæ—¶æ›´æ–°ã€‚

---

## ðŸ“‹ æµ‹è¯•å‰å‡†å¤‡

### 1. çŽ¯å¢ƒå˜é‡é…ç½®

å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶å¡«å…¥çœŸå®žçš„APIå¯†é’¥ï¼š

```bash
cp .env.example .env
```

**å¿…éœ€çš„çŽ¯å¢ƒå˜é‡ï¼š**

```env
# Supabaseï¼ˆå¿…éœ€ï¼‰
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# Apifyï¼ˆå¿…éœ€ - ç”¨äºŽçˆ¬è™«ï¼‰
APIFY_API_TOKEN=your_apify_token
APIFY_WEBHOOK_SECRET=your_random_secret_key

# Google Geminiï¼ˆå¿…éœ€ - ç”¨äºŽAIåˆ†æžï¼‰
GEMINI_API_KEY=your_gemini_api_key

# åº”ç”¨é…ç½®
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

### 2. èŽ·å–APIå¯†é’¥

#### Supabase
1. è®¿é—® [supabase.com](https://supabase.com)
2. åˆ›å»ºæˆ–æ‰“å¼€é¡¹ç›®
3. è¿›å…¥ Settings > API
4. å¤åˆ¶ `URL` å’Œ `anon key`
5. å¤åˆ¶ `service_role key`ï¼ˆç”¨äºŽæœåŠ¡ç«¯ï¼‰

#### Apify
1. è®¿é—® [apify.com](https://apify.com)
2. æ³¨å†Œè´¦å·ï¼ˆæœ‰å…è´¹é¢åº¦ï¼‰
3. è¿›å…¥ Settings > Integrations
4. åˆ›å»ºAPI Token
5. è®¾ç½® Webhook Secretï¼ˆä»»æ„éšæœºå­—ç¬¦ä¸²ï¼‰

#### Google Gemini
1. è®¿é—® [ai.google.dev](https://ai.google.dev)
2. ç‚¹å‡» "Get API Key"
3. åˆ›å»ºæˆ–é€‰æ‹©é¡¹ç›®
4. å¤åˆ¶APIå¯†é’¥

### 3. å®‰è£…ä¾èµ–

```bash
npm install
```

---

## ðŸ§ª æµ‹è¯•æ­¥éª¤

### æ­¥éª¤1: è¿è¡Œå•å…ƒæµ‹è¯•

é¦–å…ˆè¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯æ ¸å¿ƒé€»è¾‘ï¼š

```bash
node test-youtube-discovery.js
```

**é¢„æœŸè¾“å‡ºï¼š**
```
ðŸš€ å¼€å§‹æµ‹è¯•YouTubeçˆ†æ¬¾å‘çŽ°åŠŸèƒ½

ðŸ“Š æµ‹è¯•1: YouTube Shortsè¯„åˆ†ç®—æ³•
==================================================

æµ‹è¯•è§†é¢‘ 1: è¶…çº§çˆ†æ¬¾ - AIæ•™ç¨‹
--------------------------------------------------
è§‚çœ‹æ•°: 2,000,000
ç‚¹èµžæ•°: 150,000
è¯„è®ºæ•°: 5,000
è®¢é˜…æ•°: 50,000

è¯„åˆ†ç»“æžœ:
  æ€»åˆ†: 92/100
  ç­‰çº§: ðŸ”¥ Sçº§
  æ˜¯å¦çˆ†æ¬¾: âœ… æ˜¯

è¯„åˆ†ç»†èŠ‚:
  äº’åŠ¨è´¨é‡: 30.0/30
  è®¢é˜…è½¬åŒ–: 30.0/30
  æŒä¹…æ€§: 25.0/25
  å¹³å°ç‰¹æ€§: 15.0/15

âœ… æµ‹è¯•é€šè¿‡

...

ðŸŽ‰ æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡ï¼
```

å¦‚æžœæµ‹è¯•é€šè¿‡ï¼Œè¯´æ˜Žè¯„åˆ†ç®—æ³•å·¥ä½œæ­£å¸¸ã€‚

---

### æ­¥éª¤2: å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

æœåŠ¡å™¨ä¼šåœ¨ `http://localhost:3000` å¯åŠ¨ã€‚

---

### æ­¥éª¤3: è®¿é—®å‘çŽ°é¡µé¢

åœ¨æµè§ˆå™¨æ‰“å¼€ï¼š
```
http://localhost:3000/discover
```

ä½ åº”è¯¥çœ‹åˆ°ï¼š
- å¹³å°é€‰æ‹©æŒ‰é’®ï¼ˆYouTube Shorts / TikTokï¼‰
- é…ç½®è¡¨å•ï¼ˆå…³é”®è¯ã€é¢‘é“ï¼‰
- å¯åŠ¨æŒ‰é’®

---

### æ­¥éª¤4: æµ‹è¯•å‰ç«¯UIï¼ˆä¸è°ƒç”¨çœŸå®žAPIï¼‰

**æµ‹è¯•å¹³å°é€‰æ‹©ï¼š**
1. ç‚¹å‡» **YouTube Shorts** æŒ‰é’®
   - âœ… æŒ‰é’®åº”è¯¥å˜ä¸ºè“è‰²è¾¹æ¡†
   - âœ… ä¸‹æ–¹æ˜¾ç¤ºYouTubeç‰¹æ€§æç¤º
   - âœ… å…³é”®è¯å ä½ç¬¦æ˜¾ç¤ºï¼š`ä¾‹å¦‚: AIæ•™ç¨‹, Reactå¼€å‘`

2. ç‚¹å‡» **TikTok** æŒ‰é’®
   - âœ… æŒ‰é’®åº”è¯¥å˜ä¸ºç²‰è‰²è¾¹æ¡†
   - âœ… ä¸‹æ–¹æ˜¾ç¤ºTikTokç‰¹æ€§æç¤º
   - âœ… å…³é”®è¯å ä½ç¬¦æ˜¾ç¤ºï¼š`ä¾‹å¦‚: æžç¬‘, ç¾Žé£Ÿ`

**æµ‹è¯•è¡¨å•è¾“å…¥ï¼š**
1. é€‰æ‹© **YouTube Shorts**
2. æ¨¡å¼é€‰æ‹©ï¼š**å…¨é¢å‘çŽ°ï¼ˆæŽ¨èï¼‰**
3. è¾“å…¥å…³é”®è¯ï¼š`AIæ•™ç¨‹, ChatGPT, React`
4. è¾“å…¥é¢‘é“URLï¼ˆå¯é€‰ï¼‰ï¼š
   ```
   https://youtube.com/@fireship
   https://youtube.com/@ThePrimeagen
   ```

---

### æ­¥éª¤5: æµ‹è¯•APIç«¯ç‚¹ï¼ˆä½¿ç”¨curlï¼‰

åœ¨å¯åŠ¨æœåŠ¡å™¨çš„æƒ…å†µä¸‹ï¼Œæ‰“å¼€æ–°ç»ˆç«¯æµ‹è¯•APIï¼š

#### 5.1 æµ‹è¯•å¯åŠ¨ä»»åŠ¡API

```bash
curl -X POST http://localhost:3000/api/viral-discovery \
  -H "Content-Type: application/json" \
  -d '{
    "platform": "youtube_shorts",
    "mode": "combined",
    "searchKeywords": ["AIæ•™ç¨‹", "Reactå¼€å‘"],
    "monitoredChannels": ["https://youtube.com/@fireship"],
    "maxResults": 10
  }'
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "success": true,
  "job": {
    "id": "uuid-xxx",
    "platform": "youtube_shorts",
    "mode": "combined",
    "status": "processing",
    "apifyRunIds": {
      "growthRunId": "xxx",
      "shortsRunId": "yyy"
    }
  },
  "message": "YouTube Shorts viral discovery started"
}
```

âš ï¸ **æ³¨æ„**ï¼šå¦‚æžœæ²¡æœ‰é…ç½®Supabase Authï¼Œè¿™é‡Œä¼šè¿”å›ž401é”™è¯¯ã€‚è¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºéœ€è¦ç”¨æˆ·è®¤è¯ã€‚

---

### æ­¥éª¤6: æµ‹è¯•æ•°æ®åº“å†™å…¥ï¼ˆå¯é€‰ï¼‰

å¦‚æžœå·²ç»é…ç½®Supabaseï¼Œæ£€æŸ¥æ•°æ®åº“ï¼š

1. æ‰“å¼€Supabase Dashboard
2. è¿›å…¥ Table Editor
3. æŸ¥çœ‹ `crawl_jobs` è¡¨
4. åº”è¯¥èƒ½çœ‹åˆ°æ–°åˆ›å»ºçš„ä»»åŠ¡è®°å½•

---

### æ­¥éª¤7: æµ‹è¯•WebhookæŽ¥æ”¶ï¼ˆæ¨¡æ‹ŸApifyå›žè°ƒï¼‰

åˆ›å»ºæ¨¡æ‹ŸWebhookè¯·æ±‚ï¼š

```bash
curl -X POST http://localhost:3000/api/webhooks/apify \
  -H "Content-Type: application/json" \
  -d '{
    "resource": {
      "id": "test-run-id",
      "status": "SUCCEEDED",
      "defaultDatasetId": "test-dataset-id"
    }
  }'
```

è¿™ä¸ªæµ‹è¯•ä¼šå¤±è´¥ï¼ˆå› ä¸ºæ‰¾ä¸åˆ°å¯¹åº”çš„jobï¼‰ï¼Œä½†å¯ä»¥éªŒè¯webhookç«¯ç‚¹æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚

---

## ðŸ” æµ‹è¯•è¦ç‚¹æ£€æŸ¥æ¸…å•

### âœ… è¯„åˆ†ç®—æ³•éªŒè¯
- [ ] è¶…çº§çˆ†æ¬¾ï¼ˆ200ä¸‡è§‚çœ‹ï¼‰è¯„åˆ† > 90
- [ ] ä¸­ç­‰çˆ†æ¬¾ï¼ˆ80ä¸‡è§‚çœ‹ï¼‰è¯„åˆ† 70-80
- [ ] æ™®é€šè§†é¢‘ï¼ˆ5ä¸‡è§‚çœ‹ï¼‰è¯„åˆ† < 60
- [ ] äº’åŠ¨çŽ‡æƒé‡æ­£ç¡®ï¼ˆ30%ï¼‰
- [ ] è®¢é˜…è½¬åŒ–è®¡ç®—æ­£ç¡®ï¼ˆ30%ï¼‰
- [ ] æ–°è§†é¢‘ï¼ˆ3å¤©å†…ï¼‰æ–°é²œåº¦æ»¡åˆ†

### âœ… å¹³å°å·®å¼‚åŒ–
- [ ] YouTubeè¯„åˆ†é‡è§†è®¢é˜…è½¬åŒ–
- [ ] YouTubeè¯„åˆ†é‡è§†é•¿å°¾æµé‡
- [ ] çˆ†æ¬¾é˜ˆå€¼ï¼š50ä¸‡æ’­æ”¾
- [ ] AIåˆ†æžä¾§é‡ï¼šä»·å€¼ã€SEOã€è®¢é˜…

### âœ… å‰ç«¯UI
- [ ] å¹³å°é€‰æ‹©è§†è§‰å·®å¼‚åŒ–ï¼ˆè“è‰²/ç²‰è‰²ï¼‰
- [ ] å¹³å°ç‰¹æ€§æç¤ºåŠ¨æ€æ˜¾ç¤º
- [ ] è¡¨å•éªŒè¯æ­£å¸¸
- [ ] å®žæ—¶çŠ¶æ€æ›´æ–°ï¼ˆéœ€Supabase Realtimeï¼‰

### âœ… APIç«¯ç‚¹
- [ ] POST /api/viral-discovery æŽ¥å—è¯·æ±‚
- [ ] GET /api/viral-discovery?jobId=xxx è¿”å›žçŠ¶æ€
- [ ] POST /api/webhooks/apify æŽ¥æ”¶å›žè°ƒ

---

## ðŸ› å¸¸è§é—®é¢˜æŽ’æŸ¥

### é—®é¢˜1: 401 Unauthorized

**åŽŸå› ï¼š** æ²¡æœ‰é…ç½®Supabase Authæˆ–ç”¨æˆ·æœªç™»å½•

**è§£å†³ï¼š**
1. ç¡®ä¿SupabaseçŽ¯å¢ƒå˜é‡æ­£ç¡®
2. åˆ›å»ºæµ‹è¯•ç”¨æˆ·
3. æˆ–è€…æš‚æ—¶æ³¨é‡ŠæŽ‰APIä¸­çš„authæ£€æŸ¥ï¼ˆä»…æµ‹è¯•ç”¨ï¼‰

---

### é—®é¢˜2: Apify APIè°ƒç”¨å¤±è´¥

**åŽŸå› ï¼š** APIFY_API_TOKENæœªé…ç½®æˆ–æ— æ•ˆ

**è§£å†³ï¼š**
1. æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ `APIFY_API_TOKEN`
2. ç¡®è®¤Apifyè´¦å·æœ‰è¶³å¤Ÿçš„é¢åº¦
3. æ£€æŸ¥Apify Dashboardä¸­çš„API Tokenæ˜¯å¦æœ‰æ•ˆ

---

### é—®é¢˜3: Gemini APIé”™è¯¯

**åŽŸå› ï¼š** GEMINI_API_KEYæœªé…ç½®æˆ–APIé¢åº¦ç”¨å°½

**è§£å†³ï¼š**
1. æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ `GEMINI_API_KEY`
2. è®¿é—® [ai.google.dev](https://ai.google.dev) æ£€æŸ¥é…é¢
3. è€ƒè™‘å‡çº§åˆ°ä»˜è´¹è®¡åˆ’

---

### é—®é¢˜4: Webhookæ²¡æœ‰è§¦å‘

**åŽŸå› ï¼š** Apifyæœªæ­£ç¡®é…ç½®Webhook URL

**è§£å†³ï¼š**
1. åœ¨Apify Actorè®¾ç½®ä¸­æ·»åŠ Webhook URL
2. URLæ ¼å¼ï¼š`https://your-domain.com/api/webhooks/apify`
3. é€‰æ‹©äº‹ä»¶ï¼š`ACTOR.RUN.SUCCEEDED` å’Œ `ACTOR.RUN.FAILED`
4. æ·»åŠ Secretç”¨äºŽéªŒè¯

---

### é—®é¢˜5: å®žæ—¶æ›´æ–°ä¸å·¥ä½œ

**åŽŸå› ï¼š** Supabase Realtimeæœªå¯ç”¨æˆ–é…ç½®é”™è¯¯

**è§£å†³ï¼š**
1. åœ¨Supabase Dashboardå¯ç”¨Realtime
2. æ£€æŸ¥RLSç­–ç•¥æ˜¯å¦å…è®¸è®¢é˜…
3. ç¡®è®¤å‰ç«¯æ­£ç¡®è®¢é˜…äº†channel

---

## ðŸ“Š æµ‹è¯•æ•°æ®ç¤ºä¾‹

### æˆåŠŸæ¡ˆä¾‹1: AIæ•™ç¨‹è§†é¢‘

```json
{
  "title": "5åˆ†é’Ÿå­¦ä¼šä½¿ç”¨ChatGPTæå‡å·¥ä½œæ•ˆçŽ‡",
  "views": 2000000,
  "likes": 150000,
  "comments": 5000,
  "subscriberCount": 50000,
  "tags": ["AI", "æ•™ç¨‹", "ChatGPT", "æ•ˆçŽ‡"],
  "viralScore": 92,
  "grade": "ðŸ”¥ Sçº§",
  "isViral": true
}
```

### æˆåŠŸæ¡ˆä¾‹2: Reactæ•™ç¨‹

```json
{
  "title": "React Hookså®Œæ•´æŒ‡å— - ä»Žå…¥é—¨åˆ°ç²¾é€š",
  "views": 800000,
  "likes": 40000,
  "comments": 1200,
  "subscriberCount": 100000,
  "tags": ["React", "JavaScript", "å‰ç«¯"],
  "viralScore": 76,
  "grade": "â­ Bçº§",
  "isViral": true
}
```

---

## ðŸŽ¯ ä¸‹ä¸€æ­¥æµ‹è¯•

å®ŒæˆåŸºç¡€æµ‹è¯•åŽï¼Œå¯ä»¥è¿›è¡Œæ›´é«˜çº§çš„æµ‹è¯•ï¼š

1. **é›†æˆæµ‹è¯•**ï¼šæµ‹è¯•å®Œæ•´çš„çˆ¬è™« â†’ åˆ†æž â†’ å­˜å‚¨æµç¨‹
2. **æ€§èƒ½æµ‹è¯•**ï¼šæµ‹è¯•å¤„ç†å¤§é‡è§†é¢‘çš„èƒ½åŠ›
3. **è¾¹ç•Œæµ‹è¯•**ï¼šæµ‹è¯•æžç«¯æ•°æ®ï¼ˆè¶…é«˜/è¶…ä½Žæ’­æ”¾é‡ï¼‰
4. **å¹¶å‘æµ‹è¯•**ï¼šåŒæ—¶å¯åŠ¨å¤šä¸ªä»»åŠ¡
5. **é”™è¯¯æ¢å¤**ï¼šæµ‹è¯•å„ç§å¤±è´¥åœºæ™¯çš„å¤„ç†

---

## ðŸ“ æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

æµ‹è¯•å®ŒæˆåŽï¼Œè®°å½•ç»“æžœï¼š

```markdown
## YouTubeçˆ†æ¬¾å‘çŽ°åŠŸèƒ½æµ‹è¯•æŠ¥å‘Š

**æµ‹è¯•æ—¥æœŸï¼š** 2024-11-20
**æµ‹è¯•äººå‘˜ï¼š** [ä½ çš„åå­—]
**æµ‹è¯•çŽ¯å¢ƒï¼š** æœ¬åœ°å¼€å‘ / Vercelé¢„è§ˆ

### æµ‹è¯•ç»“æžœ

| æµ‹è¯•é¡¹ | çŠ¶æ€ | å¤‡æ³¨ |
|--------|------|------|
| å•å…ƒæµ‹è¯• | âœ… é€šè¿‡ | æ‰€æœ‰è¯„åˆ†ç®—æ³•æ­£ç¡® |
| å‰ç«¯UI | âœ… é€šè¿‡ | å¹³å°åˆ‡æ¢æ­£å¸¸ |
| APIç«¯ç‚¹ | âš ï¸ éƒ¨åˆ†é€šè¿‡ | Authéœ€é…ç½® |
| å®žæ—¶æ›´æ–° | ðŸš« æœªæµ‹è¯• | éœ€Supabaseé…ç½® |

### å‘çŽ°çš„é—®é¢˜

1. [é—®é¢˜æè¿°]
2. [é—®é¢˜æè¿°]

### å»ºè®®æ”¹è¿›

1. [æ”¹è¿›å»ºè®®]
2. [æ”¹è¿›å»ºè®®]
```

---

## âœ… æµ‹è¯•å®Œæˆæ ‡å‡†

æ‰€æœ‰ä»¥ä¸‹æ¡ä»¶æ»¡è¶³æ—¶ï¼Œè§†ä¸ºæµ‹è¯•å®Œæˆï¼š

- [x] å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡
- [x] å‰ç«¯UIæ­£å¸¸æ˜¾ç¤º
- [ ] APIç«¯ç‚¹æ­£å¸¸å“åº”ï¼ˆéœ€Authé…ç½®ï¼‰
- [ ] èƒ½æˆåŠŸå¯åŠ¨Apifyä»»åŠ¡
- [ ] Webhookèƒ½æ­£ç¡®å¤„ç†å›žè°ƒ
- [ ] æ•°æ®æ­£ç¡®ä¿å­˜åˆ°æ•°æ®åº“
- [ ] å®žæ—¶çŠ¶æ€æ›´æ–°æ­£å¸¸å·¥ä½œ
- [ ] çˆ†æ¬¾è¯„åˆ†å‡†ç¡®

---

**ç¥æµ‹è¯•é¡ºåˆ©ï¼ðŸš€**

æœ‰é—®é¢˜æŸ¥çœ‹ `TROUBLESHOOTING.md` æˆ–åœ¨GitHubæIssueã€‚
